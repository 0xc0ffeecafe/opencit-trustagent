<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <artifactId>api-client</artifactId>
  <packaging>jar</packaging>
  <name>API Client</name>
  <description>
      The API Client provides an easy-to-use programming interface to access 
      Mt Wilson services. Using the API Client, you can manage the Whitelist,
      manage the list of hosts being monitored, obtain attestation on the
      status of those hosts in SAML format, and more. Please see the documentation
      for complete details.
  </description>
    <parent>
		<groupId>com.intel.mtwilson.integration</groupId>
		<artifactId>mtwilson-integration</artifactId>
		<version>0.5.4-SNAPSHOT</version>
    </parent>

    <build>
	

	<testResources>
            <testResource>
                <directory>src/test/json</directory>
                <includes>
                    <include>**/*.json</include>
                </includes>
            </testResource>
            <testResource>
                <directory>src/test/env</directory>
                <includes>
                    <include>**/*.properties</include>
                </includes>
            </testResource>
            <testResource>
                <directory>src/test/resources</directory>
                <includes>
                    <include>**/*.jks</include>
                    <include>**/cacerts</include>
                    <include>**/*.html</include>
                    <include>**/*.xml</include>
                </includes>
            </testResource>
        </testResources>
	
	
		<plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <inherited>true</inherited>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
		    <skip>false</skip>
                    <showDeprecation>true</showDeprecation>
                </configuration>
            </plugin>
            
         <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <!--
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib/</classpathPrefix>
                        -->
                        <mainClass>com.intel.mtwilson.client.TextConsole</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
                    
	    <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
		<version>2.12.4</version>
                <configuration>
                    <systemProperties>
                        <property>
                            <name>java.util.logging.config.file</name>
                            <value>${project.build.directory}/test-classes/logging.properties</value> <!-- copied there by the <resources> tag above, it's in src/test/env -->
                        </property>
                    </systemProperties>
                </configuration>
            </plugin>	    
		
	    <!-- create a jar-with-dependencies.  see also:
	    http://maven.apache.org/plugins/maven-shade-plugin/examples/includes-excludes.html 
	    -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-shade-plugin</artifactId>
        <version>1.5</version>
        <executions>
            <execution>
                <id>regular-jar-with-dependencies</id>
                <phase>package</phase>
                <goals><goal>shade</goal></goals>
                <configuration>
        		<shadedArtifactAttached>true</shadedArtifactAttached>
                	<shadedClassifierName>with-dependencies</shadedClassifierName>
                </configuration>
            </execution>
          <execution>
                <id>shaded-jar-with-dependencies</id>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
            <configuration>
		<shadedArtifactAttached>true</shadedArtifactAttached>
		<shadedClassifierName>with-dependencies-shaded</shadedClassifierName> <!-- Any name that makes sense -->
		<transformers>
		    <transformer implementation="org.apache.maven.plugins.shade.resource.DontIncludeResourceTransformer">
			<resource>META-INF/BCKEY.SF</resource>
			<resource>META-INF/BCKEY.DSA</resource>
		    </transformer>
		</transformers>
		<relocations>
		    <relocation>
			<pattern>org</pattern>
			<shadedPattern>intel.apiclient.org</shadedPattern>
		    </relocation>
		    <relocation>
			<pattern>net</pattern>
			<shadedPattern>intel.apiclient.net</shadedPattern>
		    </relocation>
		    <relocation>
			<pattern>javax.activation</pattern>
			<shadedPattern>intel.apiclient.javax.activation</shadedPattern>
		    </relocation>
		    <relocation>
			<pattern>javax.ws</pattern>
			<shadedPattern>intel.apiclient.javax.ws</shadedPattern>
		    </relocation>
		    <relocation>
			<pattern>javax.xml</pattern>
			<shadedPattern>intel.apiclient.javax.xml</shadedPattern>
		    </relocation>
		    <relocation>
			<pattern>com</pattern>
			<shadedPattern>intel.apiclient.com</shadedPattern>
			<excludes>
			    <exclude>com.intel.*</exclude>
			</excludes>
		    </relocation>
		</relocations>
            </configuration>
         </execution>
        </executions>
      </plugin>
      
      <!-- begin copy dependencies plugin (to create zip file) -->
	<plugin>
	    <artifactId>maven-dependency-plugin</artifactId>
	    <version>2.4</version>
		<executions>
		    <execution>
			<phase>generate-resources</phase> <!-- was: install -->
			<goals>
			    <goal>copy-dependencies</goal>
			</goals>
			<configuration>
			    <outputDirectory>${project.build.directory}/jars</outputDirectory>
			</configuration>
		    </execution>
		</executions>
	</plugin>
    <!-- end copy dependencies plugin -->

<plugin>
	<groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-antrun-plugin</artifactId>
        <version>1.7</version>
        <executions>
          <execution>
	    <id>default-cli</id>
            <phase>compile</phase>
	    <goals>
		<goal>run</goal>
	    </goals>
            <configuration>
		<target>
	    		<zip destfile="${project.build.directory}/${project.artifactId}-${project.version}.zip">
				<fileset dir="${project.build.directory}/jars"/>
				<fileset dir="${project.build.directory}" includes="${project.artifactId}-${project.version}.jar"/>
			</zip>
		</target>
            </configuration>
          </execution>
        </executions>
            <dependencies>
		<dependency>
		    <groupId>org.apache.ant</groupId>
		    <artifactId>ant</artifactId>
		    <version>1.8.4</version>
		</dependency>
                <dependency>
                    <groupId>ant-contrib</groupId>
                    <artifactId>ant-contrib</artifactId>
                    <version>1.0b3</version>
                </dependency>
            </dependencies>
      </plugin>	    
      

        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>build-helper-maven-plugin</artifactId>
            <version>1.5</version>
            <executions>                      
                <execution>
                    <id>attach-artifacts</id>
                    <phase>package</phase>
                    <goals>
                        <goal>attach-artifact</goal>
                    </goals>
                    <configuration>
                        <artifacts>
                            <artifact>
                                <file>${project.build.directory}/${project.artifactId}-${project.version}.zip</file>
                                <type>zip</type>
                            </artifact>
                        </artifacts>
                    </configuration>
                </execution>
            </executions>
        </plugin>


    </plugins>      
      

    </build>



  <dependencies>
        <dependency>
            <groupId>com.intel.mtwilson.common</groupId>
            <artifactId>mtwilson-crypto</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>com.intel.mtwilson.common</groupId>
            <artifactId>mtwilson-io</artifactId>
            <version>${project.version}</version>
        </dependency>
	<!--
	<dependency>
		<groupId>org.glassfish</groupId>
		<artifactId>maven-embedded-glassfish-plugin</artifactId>
		<version>3.1.1</version>
		<type>maven-plugin</type>
	</dependency>    
	-->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.2</version>
            <scope>test</scope>
        </dependency>
    <dependency>
		<groupId>org.slf4j</groupId>
		<artifactId>slf4j-api</artifactId>
		<version>1.6.4</version>
    </dependency>
    <!--
    <dependency>
		<groupId>org.slf4j</groupId>
		<artifactId>slf4j-simple</artifactId>
		<version>1.6.4</version>
		<scope>provided</scope>
    </dependency>
    -->
    <dependency>
		<groupId>org.slf4j</groupId>
		<artifactId>slf4j-jdk14</artifactId>
		<version>1.6.4</version>
		<scope>test</scope>
    </dependency>
    <!--
    <dependency>
		<groupId>commons-logging</groupId>
		<artifactId>commons-logging</artifactId>
		<version>1.1.1</version>
		<scope>compile</scope>
    </dependency>
    -->
    <!--
    <dependency>
		<groupId>commons-beanutils</groupId>
		<artifactId>commons-beanutils</artifactId>
		<version>1.8.0</version>
		<scope>compile</scope>
    </dependency>
    -->
    <dependency>
		<groupId>commons-configuration</groupId>
		<artifactId>commons-configuration</artifactId>
		<version>1.9</version>
    </dependency>
	<dependency>
		<groupId>commons-codec</groupId>
		<artifactId>commons-codec</artifactId>
		<version>1.6</version>
	</dependency>
	<!--
	<dependency>
		<groupId>org.apache.commons</groupId>
		<artifactId>commons-io</artifactId>
		<version>1.3.2</version>
	</dependency>
	-->
	<!--
        <dependency>
                <groupId>com.jayway.restassured</groupId>
                <artifactId>rest-assured</artifactId>
                <version>1.5</version>
        </dependency>        
	-->
	<dependency>
	    <groupId>com.sun.xml.bind</groupId>
	    <artifactId>jaxb</artifactId>
	    <version>2.1.9</version>
	</dependency>
	<dependency>
	    <groupId>com.sun.xml.bind</groupId>
	    <artifactId>jaxb-impl</artifactId>
	    <version>2.1.9</version>
	</dependency>
	<dependency>
	    <groupId>com.intel.mtwilson.integration</groupId>
	    <artifactId>api-datatypes</artifactId>
	    <version>${project.version}</version>
	    <type>jar</type>
	</dependency>
		<dependency>
			<groupId>com.intel.mtwilson.services</groupId>
			<artifactId>MtWilsonHttpSecurity</artifactId>
			<version>${project.version}</version>
		</dependency>
    
    <!-- begin httpclient  -->
   
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2</version>
        </dependency>
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2</version>
        </dependency>
	<dependency>
		<groupId>commons-pool</groupId>
		<artifactId>commons-pool</artifactId>
		<version>1.6</version>
	</dependency>
    <!-- end httpclient -->
    
    <!-- begin jersey  -->
    
	<!-- jersey-core provides MultivaluedMap and MediaType -->
	<dependency>
	    <groupId>com.sun.jersey</groupId>
	    <artifactId>jersey-core</artifactId>
	    <version>${jersey-version}</version>
	    <type>jar</type>
	</dependency>

<!-- jersey client is used for creating JSON requests -->
    <dependency>
      <groupId>com.sun.jersey</groupId>
      <artifactId>jersey-client</artifactId>
      <version>${jersey-version}</version>
      <type>jar</type>
    </dependency>

    <!--
<dependency>
	<groupId>javax.activation</groupId>
	<artifactId>activation</artifactId>
	<version>1.1.1</version>
</dependency>
    <dependency>
		<groupId>javax</groupId>
		<artifactId>javaee-web-api</artifactId>
		<version>6.0</version>
		<scope>provided</scope>
	</dependency>
<dependency>
	<groupId>javax.mail</groupId>
	<artifactId>mail</artifactId>
	<version>1.4</version>
</dependency>
            -->
	    <!-- end jersey  -->
	    <!--
           	<dependency>
			<groupId>org.bouncycastle</groupId>
			<artifactId>bcprov-jdk15on</artifactId>
			<version>1.47</version>
		</dependency>
		-->
	<!-- start saml verification -->
	<dependency>
		<groupId>org.opensaml</groupId>
		<artifactId>opensaml</artifactId>
		<version>2.5.1-1</version>
	<exclusions>
		<exclusion>
		<artifactId>log4j-over-slf4j</artifactId>
		<groupId>org.slf4j</groupId>
		</exclusion>
<!-- this exclusion is here because we are providing our own patched version of xmltooling, see below and the "other" projects folder -->
		<exclusion>
		    <groupId>org.opensaml</groupId>
		    <artifactId>xmltooling</artifactId>
		</exclusion>
	</exclusions>	
	</dependency>
 <!-- version 1.3.2-1a IS THE INTEL MODIFIED VERSION of 1.3.2-1 WITH FIX FOR NULL POINTER EXCEPTION, SEE THE "OTHER" PROJECT FOLDER -->
	<dependency>
	    <groupId>org.opensaml</groupId>
	    <artifactId>xmltooling</artifactId>
	    <version>1.3.2-1a</version>
	</dependency>
	<!-- solves java.lang.ClassNotFoundException: org/jcp/xml/dsig/internal/dom/XMLDSigRI when verifying SAML signatures -->
	    <!-- vesrion must be 1.4.3, after this the class org.jcp.xml.dsig.internal.dom.XMLDsigRI is moved to org.apache.jcp  so opensaml doesn't find it -->
<dependency>
	<groupId>org.apache.santuario</groupId>
	<artifactId>xmlsec</artifactId>
	<version>1.4.3</version>
</dependency>
            	    
		    <dependency>
			<groupId>joda-time</groupId>
			<artifactId>joda-time</artifactId>
			<version>2.1</version>
		    </dependency>
	<!-- end saml verification -->
    
	<!-- begin sshj for remote administration -->
	<dependency>
	    <groupId>net.schmizz</groupId>
	    <artifactId>sshj</artifactId>
	    <version>0.8.0</version>
	</dependency>
	<!-- end sshj for remote administration  -->
    
    <!-- for Java 1.5 version of the api client -->
	<dependency>
	    <groupId>com.intel.mtwilson.integration</groupId>
	    <artifactId>java-backport-1.6-to-1.5</artifactId>
	    <version>0.1-SNAPSHOT</version>
	</dependency>
    <!-- end Java 1.5 backport dependencies -->
  </dependencies>  

</project>
